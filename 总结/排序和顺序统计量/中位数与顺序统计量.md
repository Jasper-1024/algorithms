# 中位数与顺序统计量

这一节似乎内容前后联系非常紧密,只能凑成长篇了.

顺序统计量:

- 一个元素互异的数组 A 的第 i 小的元素就是数组 A 的第 i 个顺序统计量.
- 最大值 i = n,最小值 i = 1.
- 中位数,需要考虑 n 奇偶,算法导论中是向下取整 $\lfloor \frac{n}{2} \rfloor$,下中位数 等同于 中位数. ^d5f9c5

最终这些问题汇聚成一个选择问题:

- 输入一个元素互异的数组 A 和整数 i ($[1,n]$)
- 输出 x ($\in{A}$),且 A 中恰好有 i -1 个元素小于 x.

## 最大最小值

单独找最大最小值,时间复杂度 $O(n)$.一个一个比较,留下那个较大/较小的.

同时找最大最小值,把上面的比较算法合并.这样比较的次数实际上是 2n-2.

还有种方法是两两比较,从较小值里再两两递归比较.这样还是 2n-2.

算法导论上提了一种:

- 记录当前最大最小值,之后输入两个值互相比较,再和当前最大最小值比较,这样 4 个数能节省 1 次比较,只需要比较 3 次.

## 期望时间为线性时间选择算法

这个算法的原理脱胎于快速排序,不断切分不断选择直到找到期望位置

伪代码 [[lec6.pdf#page=3]]

```
RAND-SELECT(A, p, q, i) // i 属于 [p..q] 
	if p= q  thenreturnA[p]
	r ← RAND-PARTITION(A, p, q)
	k ← r–p+1 // k = rank(A[r]) 随即快排的切分元素在 A 的位置
	if  i= k  then return A[r]
	if  i< k  
		then return RAND-SELECT(A, p, r –1, i)
		else return RAND-SELECT(A, r + 1, q, i –k)
```

空间复杂度一直是原地排序所以是 $O(1)$

### 最好/最坏情况

最好情况是每次都 $\frac12$ $\frac12$ 切分,这样

$$
T(n) = T(\frac12n) + \Theta(n)
$$

主定理,第三种情况.最后是 $\Theta(n)$.

其他情况下假设是 $\frac{1}{10}$ $\frac{9}{10}$ 切分,且不太幸运都在 $\frac{9}{10}$ 那一半.

$$
T(n) = T(\frac{9}{10}n) + \Theta(n)
$$

同理的主定理第三种情况,最后还是 $\Theta(n)$.

最坏情况,大概是切分每次只能使子问题规模 - 1.这样时间复杂度是等差数列求和,最后是 $O(n^2)$.

### 平均情况

与分析快速排序平均情况类似,这里要使用 [[指示器随机变量]].

定义指示器随机变量 $x_k$

$$
x_k = 
\begin{cases}
& 1 ,当切分时左侧恰好有 k 个元素\\
& 0 \\
\end{cases}
$$

与上面一样,这里假设需要寻找的元素都在更长的子数组.方便分析.则有

$$
\begin{aligned}
T(n) & \leq 
\begin{cases}
& T(max\{0,n-1\}) + \Theta(n) \\
& T(max\{1,n-2\}) + \Theta(n) \\
& ...\\
& T(max\{n-1,0\}) + \Theta(n) \\
\end{cases} \\
& = \sum_{k=1}^{n}( x_k * T(max\{k-1,n-k\}) + \Theta(n)) \\
& = \sum_{k=1}^{n}  x_k * T(max\{k-1,n-k\}) + \Theta(n)
\end{aligned}
$$

两边取期望,开始类似 [[快速排序#^889d7a|快排此处的化简]].

$$
\begin{aligned}
E[T(n)] & \leq  \\
&= E[ \sum_{k=1}^{n}  x_k * T(max\{k-1,n-k\}) + \Theta(n)] \qquad(1)\\
&= E[ \sum_{k=1}^{n}  x_k * T(max\{k-1,n-k\})] + \Theta(n) \qquad(2)\\
&= \sum_{k=1}^{n}  E[x_k] * E[T(max\{k-1,n-k\})] + \Theta(n) \qquad(3)\\
&= E[x_k] * \sum_{k=1}^{n} E[T(max\{k-1,n-k\})] + \Theta(n) \qquad(4)\\
&= \frac1n * \sum_{k=1}^{n} E[T(max\{k-1,n-k\})] + \Theta(n) \qquad(5)\\
&= \frac2n * \sum_{k = \lfloor n/2 \rfloor}^{n-1} E[T(k)] + \Theta(n) \qquad(6)\\
\end{aligned}
$$

大致过程和 [[快速排序#^889d7a|快排此处的化简]] 无二,唯一要说的是 3 --> 4 需要证明 $x_k$ 与 T 的子项是独立随机变量.

- $x_k$ 产生有效值是原问题运行快排切分后产生的随机数,而 T 的子项是下一轮的递归,下一次运行和上一次运行间没有关系,互相独立.

5 --> 6

- 消去 max,因为是取 $\{k-1,n-k\}$ 较大项,当 $k \in [1,n]$时,有一半的子问题规模是重复的.
- 类似 [[#^d5f9c5|这里]] 奇偶的考虑,取下中位数,这样将奇偶都包含了.

之后证明到了瓶颈,,,,那么 [[分治法 & 分治法分析#代入法|代入法]]...

不过我们这里要证明的是线性时间,因此假设已经确定了.

假设

- 某个常数 c 有 $E[T(n)] \leq cn$.
- 某个常数 a 有 $\Theta(n) \leq an$.

$$
\begin{aligned}
E[T(n)] & \leq \frac{n}{2} * \sum_{k = \lfloor 2/n \rfloor}^{n-1} cn + an \qquad(7)\\
& \leq \frac{2c}{n} * \frac{3}{8}n^2 + an \qquad(8)\\
& = cn - (\frac14c-a)n \qquad(9)\\
\end{aligned}
$$

7: 代入假设

7 -> 8

- $$
	\sum_{k = \lfloor 2/n \rfloor}^{n-1} n \leq 
	$$

