# 哈希函数

哈希函数将 key 均匀映射到槽位.是哈希表时间复杂度很小的基础.

这理论上哈希函数应该独立于 key 存在,对于任何 key 的集合都能均匀映射.但是没那么好的事情,常用哈希函数总是有发生哈希碰撞贼高的 key .

一节会提到 3.5 个常用哈希函数.

- 乘法/除法哈希是简单易用.为避免最坏情况,会有参数取值的限制.
- 全域哈希是给哈希函数增加了随机选择,避免最坏情况的 $n^2$ 时间复杂度
- 完全哈希则是另一种思路,根据 key 构造一个最坏情况也是 $O(1)$ 的哈希表,姑且算半个.

ps:

- 这里假设键值都是自然数.字符串等键值也转换到自然数进行 hash 运算.

## 除法哈希函数

最简单的哈希函数

$$
h(k) = k \bmod m
$$

- m 不应该太小,使得装载因子太大.
- m 不应该取 $2^r$,$10^r$.当是这些数时,相当于一直取 key 对应进制下的低位数.
- m 最好是与需求规模差不多的素数.
- 特别要避免 $h(k)$ 一直是偶数.这样一半的哈希表覆盖不到.

## 乘法哈希函数

基本步骤

- k 乘上常数 A $\in(1,0)$,提取 kA 的小数部分.
- m 乘上小数部分,向下取整

$$
h(k) = \lfloor m(kA \bmod 1) \rfloor
$$

- 对 m 取值不敏感.
- A 取值,有些蒙蔽, #todo

下面是课程中提到的乘法哈希函数.应该是二进制下的特别版

$$
h(k) = (Ak \bmod 2^w) rsh (w - r)
$$

- w 是计算机位数
- A 是奇数,在 $(2^{w-r},2^w)$ 之间.不要取 $2^r$ 及其附近值.
- rsh 是向右移位.

## 全域哈希函数

无论是乘法/除法哈希函数,总会有特定的 key 集合使得 hash 函数一直碰撞.既然单一 hash 函数无法避免这个问题,那么随机选取 hash 函数呢?

全域 hash 算每次运行时会从一组 hash 函数中随机选取一个,避免最糟糕情况出现.

设 H  是一组有限哈希函数,它的一个元素哈希函数将给定关键词的全域 U 映射到 {0,1...,m-1}中,我们称这样的函数组 H 是全域的.

任意不同的 k,l ($\in U$),满足 h(k) = h(l) 的散列函数个数至多是 $\frac{H}{m}$

- H 中有 

## \*完全哈希

